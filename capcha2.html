<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sandbox with Wooden Border</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f4f4f4;
        }

        canvas {
            border: none;
            box-shadow: 0 0 0 10px #8B4513;
        }
    </style>
</head>
<body>
    <canvas id="bacASable" width="600" height="400"></canvas>

    <script>
        const canvas = document.getElementById('bacASable');
        const ctx = canvas.getContext('2d');
        const elements = [];

        let keyPosition = { x: 0, y: 0 };

        function positionKeyRandomly() {
            const canvasWidth = canvas.width;
            const canvasHeight = canvas.height;

            const keyWidth = 60; // Taille de la clé
            const keyHeight = 20;

            const randomX = Math.random() * (canvasWidth - keyWidth);
            const randomY = Math.random() * (canvasHeight - keyHeight);

            keyPosition = { x: randomX, y: randomY };
        }

        function drawKey() {
            ctx.fillStyle = 'rgba(0, 255, 0, 0.5)';
            ctx.fillRect(keyPosition.x, keyPosition.y, 60, 20);
            ctx.fillStyle = 'white';
            ctx.font = '16px Arial';
            ctx.fillText('Verifié', keyPosition.x + 5, keyPosition.y + 15);
        }

        function generateElements() {
            const numElements = 75000;
            const shellChance = 0.002;
            const stoneChance = 0.003;

            for (let i = 0; i < numElements; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;

                if (Math.random() < shellChance) {
                    const size = Math.random() * 8 + 5;
                    elements.push({ x, y, size, type: 'shell', color: generateShellColor() });
                } else if (Math.random() < stoneChance) {
                    const size = Math.random() * 10 + 6;
                    elements.push({ x, y, size, type: 'stone', color: generateStoneColor() });
                } else {
                    const radius = Math.random() * 2 + 1;
                    const color = generateLightYellowColor();
                    elements.push({ x, y, radius, type: 'sand', color });
                }
            }
        }

        function generateLightYellowColor() {
            const r = 230 + Math.floor(Math.random() * 25);
            const g = 200 + Math.floor(Math.random() * 20);
            const b = 0 + Math.floor(Math.random() * 20);
            return `rgb(${r}, ${g}, ${b})`;
        }

        function generateShellColor() {
            const colors = ['#F5DEB3', '#FFF5EE', '#FFE4C4', '#FFDEAD'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function generateStoneColor() {
            const colors = ['#A9A9A9', '#808080', '#D3D3D3'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function drawElements() {
            elements.forEach(item => {
                if (item.type === 'sand') {
                    ctx.beginPath();
                    ctx.arc(item.x, item.y, item.radius, 0, 2 * Math.PI);
                    ctx.fillStyle = item.color;
                    ctx.fill();
                } else if (item.type === 'shell') {
                    ctx.beginPath();
                    ctx.ellipse(item.x, item.y, item.size / 2, item.size / 3, Math.PI / 4, 0, Math.PI * 2);
                    ctx.fillStyle = item.color;
                    ctx.fill();
                } else if (item.type === 'stone') {
                    ctx.beginPath();
                    ctx.ellipse(item.x, item.y, item.size / 2, item.size / 3, 0, 0, Math.PI * 2);
                    ctx.fillStyle = item.color;
                    ctx.fill();
                }
            });
        }

        function pushElements(event) {
            const mouseX = event.offsetX;
            const mouseY = event.offsetY;

            const pushDistance = 5;

            elements.forEach(item => {
                const dx = item.x - mouseX;
                const dy = item.y - mouseY;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 50) {
                    const angle = Math.atan2(dy, dx);
                    const pushX = Math.cos(angle) * pushDistance;
                    const pushY = Math.sin(angle) * pushDistance;

                    item.x += pushX;
                    item.y += pushY;
                }
            });

            drawScene();
        }

        function drawScene() {
            ctx.fillStyle = 'rgb(255, 255, 200)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            drawKey(); 
            drawElements();
        }

        function checkKeyClick(event) {
            const mouseX = event.offsetX;
            const mouseY = event.offsetY;

            const keyWidth = 60;
            const keyHeight = 20;

            if (mouseX >= keyPosition.x && mouseX <= keyPosition.x + keyWidth &&
                mouseY >= keyPosition.y && mouseY <= keyPosition.y + keyHeight) {
                alert('Écho réussi !');
            }
        }

        positionKeyRandomly();
        generateElements();
        drawScene();
        canvas.addEventListener('mousemove', pushElements);
        canvas.addEventListener('click', checkKeyClick); // Ajout de l'événement de clic
    </script>
</body>
</html>
